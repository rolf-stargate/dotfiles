# vim: filetype=neomuttrc
source /usr/share/mutt-wizard/mutt-wizard.muttrc

# Sort by threads
set sort = threads
# Sort threads by last date recieved - newest first
set sort_aux = reverse-last-date-received
# Show date in year/month/day hour:minute format
set date_format="%y/%m/%d %I:%M%p"

# Mailcap file is used to tell mutt how to open different types of file
set mailcap_path = "~/.config/mutt/mailcap"

# Tells Mutt to automatically view files with these mime types
auto_view text/html
# Order to try and show multipart emails
alternative_order text/plain text/enriched text/html

# Use nvim but don't force text width (looks terible if read on a phone)
set editor = "nvim +':set textwidth=0'"

set timeout=10
set imap_idle=true

# When looking for contacts, use this command
set query_command= "abook --datafile ~/Dropbox/addressbook --mutt-query '%s'"

# Add current sender to address book
macro index,pager  a "<pipe-message>abook --datafile ~/Dropbox/addressbook<return>" "Add this sender to Abook"

# Auto-complete email addresses by pushing tab
bind editor <Tab> complete-query

bind index,pager \Co sidebar-open
bind index,pager \Cl sidebar-open
bind index,pager <Right> sidebar-open
bind index,pager <Up> sidebar-prev
bind index,pager <Down> sidebar-next
bind index,pager D purge-message
bind pager,browser gg top-page
bind pager,browser G bottom-page
bind index,pager,browser d half-down
bind index,pager,browser u half-up
bind pager,attach h exit
bind attach <return> view-mailcap
bind attach l view-mailcap

macro index,pager Mp  "<tag-prefix><save-message>=Folders/Private<enter><enter><sync-mailbox><enter>"  "Save message to Private"
macro index,pager Mw  "<tag-prefix><save-message>=Folders/Work<enter><enter><sync-mailbox><enter>"  "Save message to Work"
macro index,pager Ma  "<tag-prefix><save-message>=Archive<enter><enter><sync-mailbox><enter>"  "Save message to Archive"
macro index,pager Ms  "<tag-prefix><save-message>=Spam<enter><enter><sync-mailbox><enter>"  "Save message to Spam"

macro index,pager d  "<tag-prefix><delete-message><enter><sync-mailbox><enter>"  "Delete message"

# macro index,pager T "<enter-command>set pipe_decode<enter><tag-prefix><pipe-message>email_task<return><enter-command>unset pipe_decode<enter><tag-prefix><modify-labels>todo\n<enter>" "Create task in Taskwarrior"

# Color definitions
set my_bg           = "color232"
set my_fg           = "color212"
set my_red          = "color197"
set my_green        = "color184"
set my_blue         = "color147"
set my_aqua         = "color80"
set my_yellow       = "color221"
set my_orange       = "color203"
set my_purple       = "color176"
set my_pink         = "color200"
set my_comment      = "color246"
set my_selection    = "color207"
set my_current_line = "color37"

# basic components
color hdrdefault $my_green $my_bg
color signature  $my_blue $my_bg
color attachment $my_yellow $my_bg
color prompt     $my_purple $my_bg
color message    $my_green $my_bg
color error      $my_red $my_bg
color indicator  $my_bg $my_selection
color status     $my_bg $my_purple
color tree       $my_blue $my_bg
color normal     $my_fg $my_bg
color markers    $my_red $my_bg
color search     $my_bg $my_yellow
color tilde      $my_purple $my_bg
color underline  $my_bg $my_yellow
color index      $my_green $my_bg ~F
color index      $my_blue $my_bg "~N|~O"
color index_author $my_pink $my_bg



### Highlights inside the body of a message ###

# URLs
color body $my_aqua $my_bg "(https?|s?ftp|news|telnet|finger|ssh)://[^ \"\t\r\n]*"
color body $my_aqua $my_bg "mailto:[-a-z_0-9.]+@[-a-z_0-9.]+"
mono body bold "(https?|s?ftp|news|telnet|finger|ssh)://[^ \"\t\r\n]*"
mono body bold "mailto:[-a-z_0-9.]+@[-a-z_0-9.]+"

# email addresses
color body $my_blue $my_bg "[-a-z_0-9.%$]+@[-a-z_0-9.]+\\.[-a-z][-a-z]+"
#mono body bold "[-a-z_0-9.%$]+@[-a-z_0-9.]+\\.[-a-z][-a-z]+"

### Header components ###

color header $my_green  $my_bg "^from:"
color header $my_green  $my_bg "^to:"
color header $my_green  $my_bg "^cc:"
color header $my_green  $my_bg "^date:"
color header $my_yellow $my_bg "^newsgroups:"
color header $my_yellow $my_bg "^reply-to:"
color header $my_aqua   $my_bg "^subject:"
color header $my_red    $my_bg "^x-spam-rule:"
color header $my_green  $my_bg "^x-mailer:"
color header $my_yellow $my_bg "^message-id:"
color header $my_yellow $my_bg "^Organization:"
color header $my_yellow $my_bg "^Organisation:"
color header $my_yellow $my_bg "^User-Agent:"
color header $my_yellow $my_bg "^message-id: .*pine"
color header $my_yellow $my_bg "^X-Fnord:"
color header $my_yellow $my_bg "^X-WebTV-Stationery:"
color header $my_yellow $my_bg "^X-Message-Flag:"
color header $my_yellow $my_bg "^X-Spam-Status:"
color header $my_yellow $my_bg "^X-SpamProbe:"
color header $my_red    $my_bg "^X-SpamProbe: SPAM"

### Coloring quoted text - coloring the first 7 levels ###

color quoted  $my_aqua   $my_bg
color quoted1 $my_yellow $my_bg
color quoted2 $my_red    $my_bg
color quoted3 $my_green  $my_bg
color quoted4 $my_aqua   $my_bg
color quoted5 $my_yellow $my_bg
color quoted6 $my_red    $my_bg
color quoted7 $my_green  $my_bg

### sidebar colors ###

color sidebar_divider   $my_comment $my_bg
color sidebar_flagged   $my_aqua $my_bg
color sidebar_highlight $my_bg $my_yellow
color sidebar_new       $my_green $my_bg
color sidebar_spoolfile $my_blue $my_bg
source /home/rolf/.config/mutt/accounts/paul.saynisch@pm.me.muttrc
macro index,pager i1 '<sync-mailbox><enter-command>source /home/rolf/.config/mutt/accounts/paul.saynisch@pm.me.muttrc<enter><change-folder>!<enter>;<check-stats>' "switch to paul.saynisch@pm.me"

